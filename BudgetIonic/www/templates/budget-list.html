<ion-view view-title="{{budgetItem.subject}}">
    <ion-content class="has-header" padding="false">
        <ion-list ng-if="budgetItem.subitems.length > 0">
            <ion-item ng-repeat="subitem in budgetItem.subitems" item="subitem" class="budget-list-item" ui-sref="budget-item-detail({itemid: subitem.id})">
                <div class="row">
                    <div class="col budget-prediction-col">
                        <div class="overlay-parent">
                            <div class="budget-prediction-gfx">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     xmlns:xlink="http://www.w3.org/1999/xlink"
                                     viewBox="0 0 80 80">
                                    <circle cx="40" cy="5" r="5" fill="{{subitem.prediction > 100 ? '#ff0000' : '#297f59'}}" />
                                    <circle cx="{{subitem.xArcEnd}}" cy="{{subitem.yArcEnd}}" r="5" fill="{{subitem.prediction > 100 ? '#ff0000' : '#297f59'}}" />
                                    <path style="{{'stroke-width:10; fill:none; stroke:' + (subitem.prediction > 100 ? '#ff0000' : '#297f59')}}" d="{{subitem.progressPath}}" />
                                </svg>
                            </div>
                            <div class="overlay">
                                <div class="budget-prediction">{{subitem.prediction + '%'}}</div>
                                <div class="budget-spent">{{subitem.spent}}</div>
                                <div class="budget-remaining">{{subitem.remaining}}</div>
                                <div class="budget-planned">{{subitem.planned}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="col budget-item-separator" ng-style="{backgroundColor:subitem.subitems.length == 0 ? '#3399ff' : '#ccc'}"></div>
                    <div class="col budget-item-main">
                        <div class="budget-name">{{subitem.subject}}</div>
                    </div>
                    <div class="col budget-item-navigation">
                        <div>
                            <span ng-hide="subitem.subitems.length == 0" class="notification">{{subitem.subitems.length}}</span>
                            <i class="icon ion-ios-arrow-right"></i>
                        </div>
                    </div>
                </div>
            </ion-item>
        </ion-list>

        <div ng-if="budgetItem.subitems.length == 0">
            <div class="row">
                <label class="col item item-input item-stacked-label">
                    <span class="input-label">Description</span>
                    <textarea placeholder="Enter a description..." ng-model="budgetItem.description"></textarea>
                </label>
            </div>
            <div class="row responsive-sm">
                <label class="col item item-input item-stacked-label">
                    <span class="input-label">Planned</span>
                    <input type="number" placeholder="Planned" ng-model="budgetItem.planned">
                </label>
                <label class="col item item-input item-stacked-label">
                    <span class="input-label">Spent</span>
                    <input type="number" placeholder="Spent" ng-model="budgetItem.spent">
                </label>
            </div>
        </div>
    </ion-content>
</ion-view>